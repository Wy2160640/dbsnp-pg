language: bash

before_install:
  - sudo apt-get update -qq
  - sudo apt-get install nkf -qq
  - sudo apt-get install pgtap
  - sudo /etc/init.d/postgresql stop
  - sudo /etc/init.d/postgresql start 9.1
  - which pg_prove
  - pg_prove --version
  - sudo cpan TAP::Parser::SourceHandler::pgTAP
  - which pg_prove
  - pg_prove --version

before_script:
  - sudo -u postgres createuser -S -R -D -E -l dbsnp
  - sudo -u postgres createdb -E UTF8 -O dbsnp -hlocalhost test_dbsnp_pg_min
  - psql -U dbsnp -hlocalhost -d test_dbsnp_pg_min -f /usr/share/postgresql/9.1/extension/pgtap--*.sql
  - cd test; ./ci/before_script.sh test_dbsnp_pg_min dbsnp

script:
  - ./ci/script.sh       test_dbsnp_pg_min dbsnp

after_script:
  - ./ci/after_script.sh test_dbsnp_pg_min dbsnp
